{% extends 'base.html' %}
{% block page_content%}
<div class="dividing_line"></div>
<div class="container-fluid index-attr">
    <div class="row">
        <div class="col-12 col-md-9 per-post-attr px-1">
            <div class="bd-title py-4 font-weight-bolder" style="text-align:center;font-size: 1.8rem;">{{ post.title }}</div>
            <div class="border-bottom border-success d-flex flex-column flex-sm-row justify-content-between">
                <span class="wordage">发表日期: {{ moment(post.timestamp).format('L') }}</span>
                <div class="d-inline">
                    <span class="wordage">阅读量: {{ post.reading_volume }}</span>
                    {% if post.category.category_name  %}
                    <span class="d-inline-block">分类: <a href="{{ url_for('main.get_posts_by_category_name', category_name=post.category.category_name)}}" class="btn btn-secondary p-0 post-btn" role="button" aria-pressed="true" style="line-height: 1.1;">{{ post.category.category_name }}</a></span>
                    {% endif %}
                    <span class="">标签: </span>
                    {% for tag in post.tags %}
                    <a href="{{ url_for('main.get_post_by_tag', name=tag.tag_name)}}" class="btn btn-secondary p-0 post-btn" role="button" aria-pressed="true" style="line-height: 1.1;">{{ tag.tag_name }}</a>
                    {% endfor%}                       
                </div>
            </div>
            <div style="height:2rem;"></div>
            <span class="" style="font-size: 1.2rem;">导语</span>
            <p class="text-muted"> {{ post.post_description }}</p>
            <div class="row no-gutters">
                <div class="col-6 col-md-10 mx-auto">
                    <div class="text-center mb-3">
                        <img src="{{ url_for('static', filename='photos/') }}{{post.image_url[14:]}}" class="img-thumbnail" alt="Responsive image">
                    </div>
                </div>
            </div>
            {% if post.body_html %}
            {{ post.body_html | safe}}
            {% else %}
            {{ post.body | safe }}
            {% endif %}
        </div>
        <div class="d-none d-md-block col-md-3 pr-md-0">
            {% include '_author_card.html' %}
            <div class="container-fluid sticky-top" style="top:10rem;">
                <span>目录</span>
                <ul data-toc class="toc_in pl-1"></ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block scripts %}
{{ super() }}
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery.toc.min.js')}}"></script>
<script>
        $(document).ready(function() {
            // 如果toc为空（只有最外层ul），隐藏整个TOC并返回
            if ($('.toc_in ul').children().length <= 0) {
                $('.toc_in').parent().css('display', 'none');
                return;
            }
    
            // 只显示1、2、3级目录列表
            $('.toc_in ul li li li ').css('display', 'none');
            // 非默认的列表样式
            $('.toc_in').find('ul').addClass('u-list-inline');
            // 2、3级目录缩进
            $('.toc_in li li').addClass('g-ml-15');
            $('.toc_in li li li').addClass('g-ml-15');
            // 链接颜色，鼠标悬停颜色
            $('.toc_in').find('a').addClass('u-link-v5 g-color-aqua g-color-red--hover');
        });
    </script>
{% endblock scripts%}
